From 98715b7d92027537c79323875044ca50464c6aef Mon Sep 17 00:00:00 2001
From: aarlaud <antoine@snyk.io>
Date: Thu, 26 Mar 2020 13:54:22 +0100
Subject: [PATCH 1/2] feat: Add longFormProjectName option

---
 src/cli/commands/monitor/index.ts | 11 +++++++++++
 src/lib/types.ts                  |  1 +
 2 files changed, 12 insertions(+)

diff --git a/src/cli/commands/monitor/index.ts b/src/cli/commands/monitor/index.ts
index 451c8f1e5..0a69bf093 100644
--- a/src/cli/commands/monitor/index.ts
+++ b/src/cli/commands/monitor/index.ts
@@ -77,8 +77,14 @@ async function monitor(...args0: MethodArgs): Promise<any> {
     throw new Error('`--remote-repo-url` is not supported for container scans');
   }
 
+  if(options.longFormProjectName && !options.allProjects) {
+    throw new Error('`--longFormProjectName` is only compatible with `--all-projects`');
+  }
+
   apiTokenExists();
 
+  
+
   // Part 1: every argument is a scan target; process them sequentially
   for (const path of args as string[]) {
     debug(`Processing ${path}...`);
@@ -116,6 +122,7 @@ async function monitor(...args0: MethodArgs): Promise<any> {
 
       analytics.add('pluginOptions', options);
       debug('getDepsFromPlugin ...');
+      
 
       // each plugin will be asked to scan once per path
       // some return single InspectResult & newer ones return Multi
@@ -155,6 +162,10 @@ async function monitor(...args0: MethodArgs): Promise<any> {
         maybePrintDeps(options, projectDeps.depTree);
 
         debug(`Processing ${projectDeps.depTree.name}...`);
+        if(options.longFormProjectName){
+          options["project-name"] = projectDeps.depTree.name + ':' +projectDeps.depTree.version
+        }
+        
         maybePrintDeps(options, projectDeps.depTree);
 
         const tFile = projectDeps.targetFile || targetFile;
diff --git a/src/lib/types.ts b/src/lib/types.ts
index 5589626e9..4d20f07c9 100644
--- a/src/lib/types.ts
+++ b/src/lib/types.ts
@@ -77,6 +77,7 @@ export interface MonitorOptions {
   // Used with the Docker plugin only. Allows requesting some experimental/unofficial features.
   experimental?: boolean;
   reachableVulns?: boolean;
+  'longFormProjectName'?: boolean;
 }
 
 export interface MonitorMeta {
